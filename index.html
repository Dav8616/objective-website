<!DOCTYPE html>
<html>
<head>
    <title>Login Page</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #121212; color: white; text-align: center; }
        #login, #objectivesPage, #completedPage { display: none; }
        .container { max-width: 600px; margin: auto; padding: 20px; }
        .sidebar { position: fixed; left: 0; top: 0; width: 200px; height: 100%; background: #1e1e1e; padding: 10px; }
        .sidebar a { display: block; color: white; padding: 10px; text-decoration: none; border-bottom: 1px solid #444; }
        .sidebar a:hover { background: #333; }
        .top-bar { background-color: #333; padding: 10px; color: white; font-size: 20px; display: flex; justify-content: space-between; align-items: center; }
        .top-bar button { background-color: #555; color: white; border: none; padding: 10px; cursor: pointer; }
        .top-bar button:hover { background-color: #444; }
        .objective { margin-bottom: 10px; padding: 10px; background-color: #2a2a2a; border-radius: 5px; }
        .objective button { margin-left: 10px; }
    </style>
</head>
<body>
    <div class="sidebar">
        <a href="#" onclick="showPage('login')" id="loginLink">Login</a>
        <a href="#" id="objectivesLink" style="display:none;" onclick="showPage('objectivesPage')">Objectives</a>
        <a href="#" id="completedLink" style="display:none;" onclick="showPage('completedPage')">Completed</a>
    </div>

    <div class="container">
        <div id="login">
            <h2>Login</h2>
            <input type="password" id="password" placeholder="Enter Password"><br><br>
            <button onclick="checkLogin()">Login</button><br><br>
            <button onclick="requestPassword()">Request Password</button>
        </div>

        <div id="objectivesPage">
            <div class="top-bar">
                <span>Objectives</span>
            </div>
            <ul id="objectiveList"></ul>
        </div>

        <div id="completedPage">
            <div class="top-bar">
                <span>Completed Objectives</span>
            </div>
            <ul id="completedList"></ul>
        </div>
    </div>

    <script>
        let objectives = []; // List of objectives
        let completedObjectives = []; // List of completed objectives
        let userPoints = 0; // User points
        let currentPassword = "randomGeneratedPassword"; // Password, to be set after "Request Password" click

        document.getElementById("login").style.display = "block";

        function checkLogin() {
            let passwordInput = document.getElementById("password").value;
            if (passwordInput === currentPassword) {
                console.log("[Login] Success: User logged in with correct password.");
                userPoints = 0; // Reset points when login
                loadObjectivesPage();
            } else {
                console.log("[Login] Error: Incorrect password.");
                alert("Incorrect password!");
            }
        }

        function requestPassword() {
            // Generate a random password
            currentPassword = Math.random().toString(36).slice(-8);
            console.log(`[Request Password] New password generated: ${currentPassword}`);

            // Generate random completion codes for the 10 objectives
            let completionCodes = [];
            for (let i = 0; i < 10; i++) {
                completionCodes.push(Math.random().toString(36).slice(-6)); // Generate a 6-character code
            }
            console.log("[Request Password] Completion codes generated: ", completionCodes);

            // Send email with password and completion codes
            sendEmail(currentPassword, completionCodes);
            alert("Password and completion codes have been sent to your email.");
        }

        function sendEmail(password, completionCodes) {
            // Fake function to simulate email sending
            console.log("[Email] Simulating email sent to david@utahpci.org.");
            console.log(`[Email] Password: ${password}`);
            console.log(`[Email] Completion Codes: ${completionCodes.join(", ")}`);
        }

        function loadObjectivesPage() {
            document.getElementById("login").style.display = "none";
            document.getElementById("objectivesLink").style.display = "block";
            document.getElementById("completedLink").style.display = "block";
            document.getElementById("objectivesPage").style.display = "block";

            // Set up objectives
            objectives = [];
            for (let i = 1; i <= 10; i++) {
                objectives.push({ name: `Objective ${i}`, description: `Description for objective ${i}`, completionCode: Math.random().toString(36).slice(-6) });
            }
            console.log("[Objectives] Objectives initialized:", objectives);
            updateObjectives();
        }

        function updateObjectives() {
            let list = document.getElementById("objectiveList");
            list.innerHTML = "";
            objectives.forEach((obj, index) => {
                let li = document.createElement("li");
                li.classList.add("objective");
                li.innerHTML = `<strong>${obj.name}</strong><br><span>${obj.description}</span>`;
                let completeBtn = document.createElement("button");
                completeBtn.innerText = "Completed";
                completeBtn.onclick = function() { completeObjective(index); };
                li.appendChild(completeBtn);
                list.appendChild(li);
            });
            console.log("[Objectives] Objective list updated.");
        }

        function completeObjective(index) {
            let completionCode = prompt("Please enter the completion code for this objective:");
            if (completionCode === objectives[index].completionCode) {
                // Award points and move to completed objectives
                userPoints += 10;
                completedObjectives.push(objectives[index]);
                objectives.splice(index, 1); // Remove completed objective from the list
                console.log(`[Objective Completed] Objective: ${objectives[index].name}, Points Awarded: 10`);
                updateObjectives();
                updateCompletedObjectives();
                alert("Objective completed! You earned 10 points.");
            } else {
                console.log("[Objective Completed] Error: Incorrect completion code.");
                alert("Incorrect completion code!");
            }
        }

        function updateCompletedObjectives() {
            let list = document.getElementById("completedList");
            list.innerHTML = "";
            completedObjectives.forEach((obj) => {
                let li = document.createElement("li");
                li.classList.add("objective");
                li.innerHTML = `<strong>${obj.name}</strong><br><span>${obj.description}</span>`;
                list.appendChild(li);
            });
            console.log("[Completed Objectives] Updated completed objectives list.");
        }

        function showPage(page) {
            document.getElementById("login").style.display = "none";
            document.getElementById("objectivesPage").style.display = "none";
            document.getElementById("completedPage").style.display = "none";
            document.getElementById(page).style.display = "block";
            console.log(`[Navigation] Showing page: ${page}`);
        }
    </script>
</body>
</html>
